
---
title: "STAT202 Assignment 3: Multiple Linear Regression II"
author: "Your Name"
date: "Due on 14th August 2024"
output:
   word_document:
      reference_docx: "template.docx"
---

#Introduction

This document contains the analysis for Assignment 3. It explores the aquatic_toxicity dataset using multiple linear regression to understand the relationships between various predictors and the response variable LC50. The analysis will follow these steps:

\newpage

Step 0: setup
loading libraries:





---
title: "STAT202 Lab 3: Multiple Linear Regression START"
author: "David Ewing"
date: "Due on 7 August 2024"
output: 
  word_document:
    reference_docx: "template.docx"
---

# Introduction
This document contains the analysis for Lab 2. It explores biometric data using multiple linear regression to understand the relationships between various predictors and the response variable weight_kg. The analysis will follow these steps:"
  
\newpage 

# Step 0: setup
loading  libraries:

```{r setup, include=TRUE}

set.seed(82171165)   #set seed 

knitr::opts_chunk$set(
  echo    = TRUE, # Show all code by default
  message = TRUE, # Include package messages
  warning = TRUE  # Include warnings if they occur
)



library(conflicted)
library(tidyverse)
library(readxl)
library(readr) 
library(performance)
library(GGally)
library(flextable)
library(broom)
library(skimr)
library(data.table)
library(lmtest)  
library(leaps)
conflict_prefer("filter", "dplyr"); conflict_prefer("select", "dplyr")

```

\newpage 

# Step 1: Read aquatic_toxicity.xlsx

```{r step1, echo=TRUE, message=TRUE}
# Load the data
toxic <- read_excel("../data/aquatic_toxicity.xlsx")



``` 



# Step 2: Select a random sample of 500 rows 

```{r step2, echo=TRUE, message=TRUE}
set.seed(82171165)

toxic_rows   <- nrow(toxic)
toxic_sample <- toxic |> slice_sample(n = 500) # without replacement
my_toxic     <- toxic_sample

# Summarise missing values 
# View the first few rows of the sample

skim_toxic <- skim(my_toxic) |>
  select(skim_variable, n_missing)
skim_toxic                           
head(toxic_sample)                   

 
```

\newpage

# Step 3: Estimate the correlations between all variables

```{r step3, echo=TRUE, message=TRUE}


cors <- cor(my_toxic) # Estimate 

cors
```
# Step 4: Top variables to predict LC50 

```{r step4, echo=TRUE, message=FALSE, fig.width=8, fig.height=6}

# 3 variables with the highest correlation with LC50
lc50_sort <- sort(cors["lc50", ], decreasing = TRUE)
lc50_sort <- lc50_sort[lc50_sort != 1]
top_3     <- names(lc50_sort[1:3])

lc50_matrix <- my_toxic[, c(top_3, "lc50")] |>
  ggpairs(
    lower = list(continuous = wrap("smooth", method = "lm", se = TRUE)),
    title = "Scatterplot Matrix: 3 top variables to predict LC50\nwith Confidence Interval"
  ) +
  theme_bw()

```
\newpage 

```{r }

lc50_matrix

```

---

A positive correlation between **mlogp** and **LC50**; with weaker positive relationships for **rdchi** and **LC50**; and an insiginficatn association between  **tpsa** and **LC50**. Each relationship appear generally linear but variability, particularly in **rdchi**, could affect predictability. THere has been no attempt to remove outliers. 

---

\newpage 

# Step 5: multiple linear regression model to predict LC50

```{r step5, echo=TRUE, message=TRUE}

lc50_arg <- as.formula(paste("lc50 ~ ", paste(top_3, collapse = " + ")))
m1       <- lm(lc50_arg, data = my_toxic)
summary(m1)
tidy(m1)
```

---

$$
LC50 = 2.6804 + 0.7416 \cdot \text{mlogp} - 0.2175 \cdot \text{rdchi} + 0.0159 \cdot \text{tpsa}
$$

---

\newpage 

# Step 6: Fit All Regression Subsets using adjusted R-squared

```{r Step 6 }

all_models <- regsubsets(lc50 ~ ., data = my_toxic)
plot(all_models, scale = "adjr2", 
     main = expression("Regression Subsets (Adjusted " ~ R^2 ~ ")"))
```

---

Both mlogp and tpsa appear here and in the coorelation matrix as good and perhaps reliable predictors for LC50, however, saacc and nn are selected the regression subsets relative to adjusted r-squared. This suggest that while they may not be strong standalone predictors, they may reduce the variablility when added to  combinations with other variables like mlogp.  

---



